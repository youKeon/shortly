## 1. 이벤트 특성

### 1.1 URL 단축 이벤트
| 항목 | 내용 |
|------|------|
| 목적 | L1(Caffeine), L2(Redis) 캐시 워밍 |
| 유실 영향 | 서비스 장애 없음 (CacheLoader가 DB 조회) |
| 트래픽 | 1,000 TPS 이하 |

### 1.2 클릭 이벤트

| 항목 | 내용 |
|------|------|
| 목적 | 클릭 정보 DB 저장 (과금 데이터) |
| 유실 영향 | 비즈니스 손실 → 유실 불가 |
| 트래픽 | 10,000 ~ 100,000 TPS |

## 2. 기술 선택

### 2.1 URL 단축 이벤트: Redis Pub/Sub

#### 이벤트 특성:
- 캐시 워밍은 즉시성이 중요
- 유실되어도 DB 조회로 대체 가능
- 읽기 중심의 서비스로 이벤트 생성이 많지 않음

#### 선택: Redis Pub/Sub
- `유실 허용`: 캐시 워밍 실패 시 `CacheLoader`가 DB 조회로 대체 가능
- `인프라 단순화`: 이미 사용 중인 Redis 활용, 추가 인프라 불필요
- `트래픽 규모`: 1,000 TPS 이하의 트래픽 → Kafka는 오버엔지니어링

#### 이벤트 흐름

![img_13.png](img_13.png)

### 2.2 클릭 이벤트: Kafka

#### 이벤트 특성:
- 클릭 이벤트는 과금 데이터로 유실 불가
- 읽기 중심의 서비스로 고처리량 지원이 필요

#### 선택: Kafka

- `고처리량`: 10,000~100,000 TPS 목표 → Kafka의 파티셔닝으로 수평 확장 가능
- `메시지 보장`: At-Least-Once 전달 보장 + 멱등성 처리로 과금 정확성 확보
- `장애 복구`: Offset 기반 메시지 보관으로 Consumer 재시작 시 재처리 가능

#### 이벤트 흐름
![img_14.png](img_14.png)
